[Config]
MinimumVersion=commit:dec7c3e754810ae6d2382d0b5e4762d7250b0254

[Output]
RepartDirectories=mkosi.repart
OutputDirectory=mkosi.output

[Build]
History=yes
ToolsTree=default
BuildDirectory=mkosi.builddir
CacheDirectory=mkosi.cache
Incremental=yes

[Validation]
SecureBoot=yes
SecureBootAutoEnroll=no

[Content]
Bootable=yes
ShimBootloader=unsigned

# Default configuration is systemd-boot + UKI, can be overridden
# on the command line or via mkosi/mkosi.local.conf
Bootloader=systemd-boot-signed
UnifiedKernelImages=unsigned

SELinuxRelabel=no
KernelInitrdModules=default
KernelCommandLine=
        systemd.show_status=0
        systemd.log_ratelimit_kmsg=0
        printk.devkmsg=on
        rw
        selinux=0
        systemd.firstboot=no
        oops=panic
        panic=-1
        softlockup_panic=1
        panic_on_warn=1
        mitigations=off

Packages=
        mokutil
        openssl

[Runtime]
FirmwareVariables=%O/ovmf_vars.fd
Firmware=uefi-secure-boot
Credentials=
        journal.storage=persistent
        tty.serial.hvc0.agetty.autologin=root
        tty.serial.hvc0.login.noauth=yes
        tty.console.agetty.autologin=root
        tty.console.login.noauth=yes
        tty.virtual.tty1.agetty.autologin=root
        tty.virtual.tty1.login.noauth=yes
RuntimeBuildSources=yes
RuntimeScratch=no
CPUs=2
VSock=yes
TPM=yes

[Include]
Include=mkosi-vm
